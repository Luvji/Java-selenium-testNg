/*
 * Launch a browser and open the URL (https://testautomationpractice.blogspot.com/)
1.Verify the page title using assertions
2.Select first 3 check boxes of Days
3.Unselect the checkboxes if they are selected
4.Navigate to the URL (https://the-internet.herokuapp.com/javascript_alerts)
5.Verify the title
6.Click on prompt alert and enter the value 'Welcome' in input box and close the alert by clicking ok button
 */



import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

import static org.junit.Assert.assertEquals;

import java.time.Duration;
import java.util.List;

public class Selenium {

  // Urls and titles
  static String url1 = "https://testautomationpractice.blogspot.com/";
  static String url1_Title = "Automation Testing Practice";

  static String url2 = "https://the-internet.herokuapp.com/javascript_alerts";
  static String url2_Title = "The Internet";

  // locators
  static String loc_checkboxCss = "div.form-check.form-check-inline input[type='checkbox']";
  static String loc_buttonXpath = "//button[text()='Click for JS Prompt']";
  static String alertText = "You entered: Welcome";

  public static void delay(long sec) {
    sec = sec > 0 ? sec : 1;
    try {
      Thread.sleep((long) sec * 1000); // Sleep for the specified duration
    } catch (InterruptedException e) {
      e.printStackTrace();
    }
  }

  public static void delay() {
    delay(1); // Default to 1 second
  }

  public static void main(String a[]) {

    System.out.println("\nStarting webdriver... \n\n");
    WebDriver driver = new ChromeDriver();
    WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));

    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(5));

    try {

      driver.get(url1);
      driver.manage().window().maximize();

      String title = driver.getTitle();
      assertEquals(url1_Title, title);

      // selecting checkbox with tag input under specific div
      List<WebElement> checkboxes = driver.findElements(By.cssSelector(loc_checkboxCss));
      ((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({behavior: 'auto', block: 'center', inline: 'center'});", checkboxes.get(0));

      // selecting first 3 check boxes
      for (int i = 0; i < 3 && i < checkboxes.size(); i++) {
        WebElement checkbox = checkboxes.get(i);
        if (!checkbox.isSelected()) {
          System.out.println("clicked");
          checkbox.click();
          delay();
        }
      }

      // unselecting 3 check boxes.
      for (int i = 0; i < 3 && i < checkboxes.size(); i++) {
        WebElement checkbox = checkboxes.get(i);
        if (checkbox.isSelected()) {
          System.out.println("unclicked");
          checkbox.click();
          delay();
        }
      }

      // navigating to new url
      driver.navigate().to(url2);
      title = driver.getTitle();
      assertEquals(url2_Title, title);
      delay();

      // interacting with alert
      System.out.println("Clicking JS Prompt button...");
      WebElement element = driver.findElement(By.xpath(loc_buttonXpath));
      element.click();
      System.out.println("Waiting for alert...");
      wait.until(ExpectedConditions.alertIsPresent());

      System.out.println("Interacting with alert...");
      Alert alert = driver.switchTo().alert();
      alert.sendKeys("Welcome");
      delay();

      alert.accept();
      delay();

      WebElement result = driver.findElement(By.id("result"));
      String resultText = result.getText();
      System.out.println("Result text: " + resultText);
      assertEquals("Result text does not match!", alertText, resultText);
      delay();

    } catch (AssertionError e) {
      System.out.println("\n\nAssertion failed: \n\t" + e);

    } catch (Exception e) {
      System.out.println("\n\nError : \n\t" + e);

    } finally {

      driver.close();
      driver.quit();
      System.exit(0);
    }
  }

}
